<!DOCTYPE html>
<html>
  <head>
    <title>Insteadman</title>
      <script src="./vendor/jquery/jquery-2.1.4.min.js"></script>
  </head>
  <body>
    <h1>Insteadman</h1>
    <img src="./resources/images/logo.png" alt="Insteadman">
    <table id="games_list">
        <tr>
            <th>Title</th>
            <th>Version</th>
            <th>Size</th>
        </tr>
    </table>

    <script>
        var gui = require('nw.gui');
        var mb = new gui.Menu({type:"menubar"});
        mb.createMacBuiltin("Insteadman");
        gui.Window.get().menu = mb;

        var interpreterFinder = require('./lib/interpreter_finder');
        var insteadInterpreterFinder = new interpreterFinder.InsteadInterpreterFinderMac;
//        insteadInterpreterFinder.findInterpreter(function(interpreterPath) {
//            insteadInterpreterFinder.checkInterpreter(interpreterPath, function(version) {
//                version = version || "not found";
//                document.getElementById('interpreter_version').innerText = version;
//            });
//        });

        var configurator = new (require('./lib/configurator').ConfiguratorMac);
//        console.log(configurator.getValue("lang"));
//        console.log(configurator.getValue("lang1"));
//        configurator.setValue("lang1", "dd");
//        console.log(configurator.getAll());
//        if (configurator.save()) {
//            console.log("ok");
//        }

        var statusBar = require('status-bar');
        var bar = statusBar.create({ total: 0 })
        //barformatter = new statusBar.Formatter(statusBar);

        var manager = new (require('./lib/manager').ManagerMac)(configurator);
//        manager.updateRepositories();
        var gamesHtml = '';
        manager.getGameList().forEach(function (game) {
            gamesHtml += '<tr><td>' + game.title + '</td><td>' + game.version + '</td><td>' + bar.format.storage(game.size) + '</td></tr>';
        })
        $('#games_list').append(gamesHtml);
    </script>
  </body>
</html>
